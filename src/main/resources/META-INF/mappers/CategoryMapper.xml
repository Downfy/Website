<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.downfy.persistence.repositories.category.CategoryRepository">

    <cache type="org.mybatis.caches.ehcache.EhcacheCache"/>

    <select id="findAll" resultType="CategoryDomain" flushCache="false" useCache="true">
        SELECT ID, PARENT, NAME, URL, ENABLED, SORT 
        FROM categories
        ORDER BY PARENT, URL
    </select>
    
    <select id="findById" resultType="CategoryDomain" flushCache="false" useCache="true">
        SELECT ID, PARENT, NAME, URL, ENABLED, SORT 
        FROM categories
        WHERE ID = #{id}
    </select>
    
    <select id="findByUrl" resultType="CategoryDomain" flushCache="false" useCache="true">
        SELECT ID, PARENT, NAME, URL, ENABLED, SORT 
        FROM categories
        WHERE URL = #{url}
    </select>
    
    <insert id="save" parameterType="CategoryDomain" flushCache="true">
        INSERT INTO categories
        (NAME, URL, PARENT)
        VALUES
        (#{name},#{url},#{parent})
    </insert>
    
    <update id="update" flushCache="true">
        UPDATE categories
        SET 
        PARENT = #{parent},
        NAME = #{name},
        URL = #{url},
        SORT = #{sort},
        ENABLED = #{enabled}
        WHERE ID = #{id}
    </update>
    
    <delete id="delete" flushCache="true">
        DELETE FROM categories
        WHERE URL = #{url}
    </delete>
</mapper>